---
title: "Lukasz Tworzydlo, gd29623"
output: html_notebook
---

# Multidimensional Data Analysis with R
# [exam with imported dataset (.csv file)]

# 1. Selected data & Student Info

- Used CSV Data
    - Used 'Artistic Preferences Scale' dataset from Open-Source Psychometrics Project.
    - Open psychology data [raw data]: (https://openpsychometrics.org/_rawdata/).
- Student Data:
    - Full name: Lukasz Tworzydlo
    - Nr albumu: gd29623
- Additional info:
    - Multidimensional Data Analysis with R
    - Group: INIS6_wszyscy

# 2. Import Data [CSV]

```{r}
APS_data <- read.delim("~/RProjects/MDA_LukaszTworzydlo_gd29623/APS_Data/APS_data.csv", stringsAsFactors=TRUE)
```

# 3. Load Libraries [FactoMineR, factoextra and ggplot2]

```{r}
library(FactoMineR)
library(factoextra)
library(ggplot2)
```

# 4. Descriptive Analysis: Tables and Figures with GGPLOT2

```{r}
summary(APS_data)
```

```{r}
head(APS_data)
```

## 4.1. Frequency Table for Categorical Variables & Descriptive Statistics for Numeric Variables

Frequency table for a categorical variable: gender
0 (no answer); 1 (female); 2 (male); 3 (other)

```{r}
table(APS_data$gender)
```

```{r}
summary(APS_data$gender)
```

Frequency table for a categorical variable: education
0 (no answer); 1 (less than high school); 2 (high school); 3 (university degree); 4 (graduate degree)

```{r}
table(APS_data$education)
```

```{r}
summary(APS_data$education)
```


Frequency table for a categorical variable: religion
0 (no answer); 1 (Agnostic); 2 (Atheist); 3 (Buddhist); 4 (Christian [Catholic]); 5 (Christian [Mormon]); 6 (Christian [Protestant]); 7 (Christian [Other]); 8 (Hindu); 9 (Jewish); 10 (Muslim); 11 (Sikh); 12 (Other)

```{r}
table(APS_data$religion)
```

```{r}
summary(APS_data$religion)
```

Frequency table for a categorical variable: TIPI9 (calm, emotionally stable)
0 = No answer
1 = Disagree strongly
2 = Disagree moderately
3 = Disagree a little
4 = Neither agree nor disagree
5 = Agree a little
6 = Agree moderately
7 = Agree strongly

```{r}
table(APS_data$TIPI9)
```

```{r}
summary(APS_data$TIPI9)
```

## 4.2. Figures with GGPLOT2

**Histogram** of TIPI9:
TIPI9	Calm, emotionally stable.
0 = No answer
1 = Disagree strongly
2 = Disagree moderately
3 = Disagree a little
4 = Neither agree nor disagree
5 = Agree a little
6 = Agree moderately
7 = Agree strongly

```{r}
ggplot(data = APS_data) +
  geom_histogram(mapping = aes(x = TIPI9), bins = 30, fill = "grey", color = "blue") +
  ggtitle("Histogram of TIPI9") +
  xlab("TIPI9") +
  ylab("Frequency")
```
- Conclusions *Histogram of TIPI9*
    - this Histogram shows the distribution of responses for TIPI9 (Calm, emotionally stable). The responses are fairly evenly distributed, with a slight peak at 5

**Histogram** of religion:
0 (no answer); 1 (Agnostic); 2 (Atheist); 3 (Buddhist); 4 (Christian [Catholic]); 5 (Christian [Mormon]); 6 (Christian [Protestant]); 7 (Christian [Other]); 8 (Hindu); 9 (Jewish); 10 (Muslim); 11 (Sikh); 12 (Other)

```{r}
ggplot(data = APS_data) +
  geom_histogram(mapping = aes(x = religion), bins = 30, fill = "lightblue", color = "black") +
  ggtitle("Histogram of Religion") +
  xlab("Religion Type") +
  ylab("Frequency")
```
- Conclusions *Histogram of religion*
    - this Histogram shows the distribution of different religions among respondents, highlighting the diversity of religious beliefs

**Bar Plot** of Gender:
0 (no answer); 1 (female); 2 (male); 3 (other)

```{r}
ggplot(data = APS_data) +
  geom_bar(mapping = aes(x = gender), fill = "gold") +
  ggtitle("Bar Plot of Gender") +
  xlab("Gender") +
  ylab("Count")

```
- Conclusions *Bar Plot of Gender*
    - this Bar Plot visualizes the count of each gender category, confirming the higher number of male respondents

**BoxPlot** Comparison: Religion by Education categories:

```{r}
ggplot(data = APS_data) +
  geom_boxplot(mapping = aes(x = religion, y = education), fill = "pink") +
  ggtitle("Box Plot of Religion by Education") +
  xlab("Religion") +
  ylab("Education")

```
- Conclusions *BoxPlot Comparison*
    - this Box Plot shows the distribution of education levels across different religious affiliations

**Scatter Plot** for Two Numeric Variables
TIPI4	Anxious, easily upset.
TIPI9	Calm, emotionally stable.

0 = No answer
1 = Disagree strongly
2 = Disagree moderately
3 = Disagree a little
4 = Neither agree nor disagree
5 = Agree a little
6 = Agree moderately
7 = Agree strongly

```{r}
ggplot(data = APS_data) +
  geom_point(mapping = aes(x = TIPI4, y = TIPI9), color = "brown") +
  ggtitle("Scatter Plot of TIPI4 vs TIPI9") +
  xlab("TIPI4") +
  ylab("TIPI9")
```
- Conclusions *Scatter Plot for Two Numeric Variables*
    - this Scatter Plot visualizes the relationship between TIPI4 (Anxious, easily upset) and TIPI9 (Calm, emotionally stable)

# 5.Principal Component Analysis

APS Data Preparation for PCA

```{r}
numeric_variables <- APS_data[, grep("^RA|^LP|^MF|^V", names(APS_data))]
```

```{r}
res.pca <- PCA(numeric_variables, graph = F)
```

## 5.1. Summary of the Results

```{r}
summary(res.pca)
```

## 5.2. Analyze the Eigen Values

```{r}
eigenvalues <- round(res.pca$eig, 3)
eigenvalues
```

## 5.3. Visualization of the Eigen Values

```{r}
fviz_screeplot(res.pca)
```
- Conclusions: this scree plot visualizes the eigenvalues, helping to determine the number of components to retain. The plot shows a gradual decrease, indicating that the first few components capture most of the variance

## 5.4. Variables Plot (Variables Dimension - Circle of Correlation)

```{r}
round(res.pca$var$coord, 3)
```

```{r}
plot.PCA(res.pca, choix = "var")
# fviz_pca_var(res.pca)
```
- Conclusions: this plot shows the correlation between variables and the principal components. Variables with high loadings on the same component are strongly correlated

## 5.5. Units Plot

```{r}
round(res.pca$ind$coord, 3)
```

```{r}
plot.PCA(res.pca, choix = "ind")
```
- Conclusions: this plot visualizes the individuals in the principal component space, showing how they are distributed across the first two dimensions

## 5.6. Biplot

```{r}
fviz_pca_biplot(res.pca)
```
- Conclusions: the biplot combines the individuals and variables plots, providing a comprehensive view of the relationships in the data

## 5.7. Additional - Contributions of Variables to Dimensions (Dim1 & Dim2)

```{r}
fviz_pca_contrib(res.pca, choice = "var", axes = 1)
fviz_pca_contrib(res.pca, choice = "var", axes = 2)
```
- Conclusions: these plots show which variables contribute most to the first two dimension







